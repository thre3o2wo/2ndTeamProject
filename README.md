# ğŸ¯ AI+X 2nd PROJECT

## ğŸ“Œ í”„ë¡œì íŠ¸ ê°œìš”
- **í”„ë¡œì íŠ¸ëª…**: ë²•ë¥  RAG ê¸°ë°˜ ì£¼íƒ ì„ëŒ€ì°¨ê³„ì•½ ë¦¬ìŠ¤í¬ ë¶„ì„ AI ì±—ë´‡
- **ê°œë°œ ê¸°ê°„**: 2026.01.12 - 2026.02.10 (4ì£¼)
- TEAM ì•ˆì „í•œå®¶
- ë°•ìƒìš© ê¹€ì¬í•™ ê¹€ì§€í›ˆ ê¹€íš¨ê²½
- [KDT] ê¸°ì—…ë§ì¶¤í˜• AI+X ìœµë³µí•© ì¸ì¬ ì–‘ì„± ê³¼ì • 2ì°¨ íŒ€í”„ë¡œì íŠ¸

# ğŸ  ë²•ë¥  AI ìƒë‹´ ì±—ë´‡ (Housing Legal AI Chatbot)

> **ì£¼íƒ ì„ëŒ€ì°¨(ì „ì›”ì„¸) ë²•ë¥  ìƒë‹´ì„ ìœ„í•œ RAG ê¸°ë°˜ AI ì±—ë´‡**

ì£¼íƒì„ëŒ€ì°¨ë³´í˜¸ë²•, ê´€ë ¨ ê·œì •, íŒë¡€ë¥¼ ê²€ìƒ‰í•˜ê³  GPTë¥¼ í™œìš©í•˜ì—¬ ë²•ë¥  ìƒë‹´ ë‹µë³€ì„ ìƒì„±í•˜ëŠ” í•˜ì´ë¸Œë¦¬ë“œ RAG(Retrieval-Augmented Generation) ì‹œìŠ¤í…œì…ë‹ˆë‹¤.

---

## ğŸ“‘ ëª©ì°¨

1. [Project Overview](#-Project-Overview)
2. [ì‹œìŠ¤í…œ ê°œìš”](#-ì‹œìŠ¤í…œ-ê°œìš”)
3. [ì „ì²´ íŒŒì´í”„ë¼ì¸ ì•„í‚¤í…ì²˜](#-ì „ì²´-íŒŒì´í”„ë¼ì¸-ì•„í‚¤í…ì²˜)
4. [ì£¼ìš” ê¸°ëŠ¥](#-ì£¼ìš”-ê¸°ëŠ¥)
5. [ì²˜ë¦¬ ë‹¨ê³„ë³„ íë¦„](#-ì²˜ë¦¬-ë‹¨ê³„ë³„-íë¦„)
6. [í•µì‹¬ ëª¨ë“ˆ ìƒì„¸](#-í•µì‹¬-ëª¨ë“ˆ-ìƒì„¸)
7. [ì£¼ìš” ë¼ì´ë¸ŒëŸ¬ë¦¬](#-ì£¼ìš”-ë¼ì´ë¸ŒëŸ¬ë¦¬)
8. [í”„ë¡œì íŠ¸ êµ¬ì¡°](#-í”„ë¡œì íŠ¸-êµ¬ì¡°)
9. [ì„¤ì¹˜ ë° í™˜ê²½ ì„¤ì •](#-ì„¤ì¹˜-ë°-í™˜ê²½-ì„¤ì •)
10. [ì‹¤í–‰ ë°©ë²•](#-ì‹¤í–‰-ë°©ë²•)
11. [API ì‚¬ìš©ë²•](#-api-ì‚¬ìš©ë²•)
12. [ì„¤ì • ì»¤ìŠ¤í„°ë§ˆì´ì§•](#-ì„¤ì •-ì»¤ìŠ¤í„°ë§ˆì´ì§•)
13. [ë¬¸ì œ í•´ê²°](#-ë¬¸ì œ-í•´ê²°)

---
## ğŸ“½ Project Overview
<img width="1280" height="720" alt="Legal AI Chatbot Project Report (0)" src="https://github.com/user-attachments/assets/7d47b472-5533-4409-94e4-2f551c9edac0" />
<img width="1280" height="720" alt="Legal AI Chatbot Project Report (1)" src="https://github.com/user-attachments/assets/0e257f0d-f2e7-4af0-836f-41b0c22a402c" />
<img width="1280" height="720" alt="Legal AI Chatbot Project Report (2)" src="https://github.com/user-attachments/assets/a359fb42-29cd-4ef9-a3e7-d8db9cd61324" />
<img width="1280" height="720" alt="Legal AI Chatbot Project Report (3)" src="https://github.com/user-attachments/assets/93e1d4d9-81ea-42e6-87c9-ac83f9edfaa2" />
<img width="1280" height="720" alt="Legal AI Chatbot Project Report (4)" src="https://github.com/user-attachments/assets/6f49251d-6846-4314-be0a-fc961d1a1ef3" />
<img width="1280" height="720" alt="Legal AI Chatbot Project Report (5)" src="https://github.com/user-attachments/assets/0a77619f-756b-4306-b779-cc4f75f479c4" />
<img width="1280" height="720" alt="Legal AI Chatbot Project Report (6)" src="https://github.com/user-attachments/assets/d6fd7faa-981c-488e-82d4-37cc72b96ebd" />
<img width="1280" height="720" alt="Legal AI Chatbot Project Report (7)" src="https://github.com/user-attachments/assets/79c39dda-36fc-4760-a171-0fd311800b45" />
<img width="1280" height="720" alt="Legal AI Chatbot Project Report (8)" src="https://github.com/user-attachments/assets/f75f856f-d453-43ee-8d06-95d2e475b81e" />
<img width="1280" height="720" alt="Legal AI Chatbot Project Report (9)" src="https://github.com/user-attachments/assets/65de1c2f-38e5-4733-ab81-26155919aa66" />
<img width="1280" height="720" alt="Legal AI Chatbot Project Report (10)" src="https://github.com/user-attachments/assets/f640b531-533a-4f98-82e5-0ab953b3424b" />
<img width="1280" height="720" alt="Legal AI Chatbot Project Report (11)" src="https://github.com/user-attachments/assets/847d8de9-3666-44e3-8334-09e2b5699785" />
<img width="1280" height="720" alt="Legal AI Chatbot Project Report (12)" src="https://github.com/user-attachments/assets/8febe92b-006b-4fe0-94c3-11658e6ccd0d" />
<img width="1280" height="720" alt="Legal AI Chatbot Project Report (13)" src="https://github.com/user-attachments/assets/6b3ab8f6-8cf8-495c-a310-8508c3a84363" />
<img width="1280" height="720" alt="Legal AI Chatbot Project Report (14)" src="https://github.com/user-attachments/assets/f2b98a7f-73f2-4023-a921-6b2588319136" />
<img width="1280" height="720" alt="Legal AI Chatbot Project Report (15)" src="https://github.com/user-attachments/assets/cef715ca-d3c5-4973-ba29-c24ccb2cf343" />
<img width="1280" height="720" alt="Legal AI Chatbot Project Report (16)" src="https://github.com/user-attachments/assets/a4c89f8a-47d1-46ba-92e6-04ef25d61a39" />
<img width="1280" height="720" alt="Legal AI Chatbot Project Report (17)" src="https://github.com/user-attachments/assets/9588d4c3-0c77-4892-8f0a-11314aec38df" />
<img width="1280" height="720" alt="Legal AI Chatbot Project Report (18)" src="https://github.com/user-attachments/assets/0db11005-20c9-4e71-be91-e4d995ba5740" />
<img width="1280" height="720" alt="Legal AI Chatbot Project Report (19)" src="https://github.com/user-attachments/assets/4202912a-ceb2-4449-bcd5-1828fcbb445d" />
<img width="1280" height="720" alt="Legal AI Chatbot Project Report (20)" src="https://github.com/user-attachments/assets/6a0d9c7b-8c6a-46a6-a74b-7ce7d2cc97cb" />
<img width="1280" height="720" alt="Legal AI Chatbot Project Report (21)" src="https://github.com/user-attachments/assets/a174a34a-383b-470e-8486-eb9bc943cd91" />
<img width="1280" height="720" alt="Legal AI Chatbot Project Report (22)" src="https://github.com/user-attachments/assets/aab422d4-4f55-4046-ab87-30b9f2352055" />

[![ì‹œì—° ì˜ìƒ ë§í¬](https://img.youtube.com/vi/GFpilFkehSo/0.jpg)](https://www.youtube.com/watch?v=GFpilFkehSo) ğŸ‘ˆ ì‹œì—° ì˜ìƒ ë§í¬

<img width="1280" height="720" alt="Legal AI Chatbot Project Report (24)" src="https://github.com/user-attachments/assets/26ed3600-488a-43e0-895d-e6af7b47ac2e" />
<img width="1280" height="720" alt="Legal AI Chatbot Project Report (25)" src="https://github.com/user-attachments/assets/2e097902-e11f-4575-b1c3-92e2b7e86167" />
<img width="1280" height="720" alt="Legal AI Chatbot Project Report (26)" src="https://github.com/user-attachments/assets/6c9c54d8-bc75-406b-9813-350dc0c8247c" />

---
## ğŸ¯ ì‹œìŠ¤í…œ ê°œìš”

### í•´ê²°í•˜ê³ ì í•˜ëŠ” ë¬¸ì œ
- ì¼ë°˜ì¸ì´ ë²•ë¥  ìš©ì–´ë¥¼ ëª¨ë¥´ë”ë¼ë„ ì‰½ê²Œ ì£¼íƒ ì„ëŒ€ì°¨ ê´€ë ¨ ë²•ë¥  ìƒë‹´ì„ ë°›ì„ ìˆ˜ ìˆì–´ì•¼ í•¨
- ë‹µë³€ì€ ë²•ë ¹, ê·œì •, íŒë¡€ì— ê·¼ê±°í•´ì•¼ í•˜ë©°, ì¶œì²˜ê°€ ëª…í™•í•´ì•¼ í•¨
- ì‚¬ìš©ìê°€ ê³„ì•½ì„œë¥¼ ì²¨ë¶€í•˜ë©´ í•´ë‹¹ ê³„ì•½ì„œ ë‚´ìš©ì„ ë¶„ì„ì— ë°˜ì˜í•´ì•¼ í•¨

### í•µì‹¬ ê¸°ìˆ 
| ê¸°ìˆ  | ì„¤ëª… |
|------|------|
| **Hybrid RAG** | Dense(Pinecone) + Sparse(BM25) ê²€ìƒ‰ ê²°í•© |
| **Query Normalization** | ì¼ìƒì–´ â†’ ë²•ë¥  ìš©ì–´ ìë™ ë³€í™˜ |
| **Reranking** | Cohere rerankerë¡œ ê²€ìƒ‰ ê²°ê³¼ ì •ë°€ ì •ë ¬ |
| **OCR Integration** | PDF/ì´ë¯¸ì§€ ê³„ì•½ì„œ í…ìŠ¤íŠ¸ ì¶”ì¶œ |
| **Legal Hierarchy** | ë²•ì  ìœ„ê³„(ë²•ë ¹ > ê·œì • > íŒë¡€)ì— ë”°ë¥¸ ì°¸ì¡° êµ¬ë¶„ |

---

## ğŸ— ì „ì²´ íŒŒì´í”„ë¼ì¸ ì•„í‚¤í…ì²˜

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                              ì‚¬ìš©ì ì¸í„°í˜ì´ìŠ¤ (Django)                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚   ì§ˆë¬¸ ì…ë ¥ (Text)   â”‚    â”‚   íŒŒì¼ ì—…ë¡œë“œ (PDF)  â”‚    â”‚   íŒŒì¼ ì—…ë¡œë“œ (IMG) â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â”‚                          â”‚                          â”‚
              â”‚                          â–¼                          â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                              OCR ëª¨ë“ˆ (ocr_module.py)                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  PDF: pdfplumber(í…ìŠ¤íŠ¸) â†’ PyMuPDF(ë Œë”) â†’ EasyOCR/Tesseract(ì´ë¯¸ì§€OCR)  â”‚  â”‚
â”‚  â”‚  ì´ë¯¸ì§€: EasyOCR(ìš°ì„ ) â†’ Tesseract(í´ë°±)                                 â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â”‚                         â”‚ extra_context (ê³„ì•½ì„œ í…ìŠ¤íŠ¸)
              â–¼                         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                            RAG íŒŒì´í”„ë¼ì¸ (rag_module.py)                      â”‚
â”‚                                                                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ STEP 1: ì§ˆë¬¸ í‘œì¤€í™” (Query Normalization)                                â”‚  â”‚
â”‚  â”‚         â€¢ Upstage SOLAR Pro2 Chat ëª¨ë¸ ì‚¬ìš©                              â”‚  â”‚
â”‚  â”‚         â€¢ ì¼ìƒì–´ â†’ ë²•ë¥  ìš©ì–´ ë³€í™˜ (ì˜ˆ: "ì§‘ì£¼ì¸" â†’ "ì„ëŒ€ì¸")                â”‚  â”‚
â”‚  â”‚         â€¢ í‚¤ì›Œë“œ ì‚¬ì „(KEYWORD_DICT) ì°¸ì¡°                                 â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                      â”‚ normalized_query                       â”‚
â”‚                                      â–¼                                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ STEP 2: í•˜ì´ë¸Œë¦¬ë“œ ê²€ìƒ‰ (Triple Hybrid Retrieval)                         â”‚  â”‚
â”‚  â”‚                                                                          â”‚  â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                 â”‚  â”‚
â”‚  â”‚  â”‚ ë²•ë ¹ (law)   â”‚   â”‚ ê·œì • (rule)   â”‚   â”‚ íŒë¡€ (case)  â”‚                 â”‚  â”‚
â”‚  â”‚  â”‚  law-index   â”‚   â”‚  rule-index  â”‚   â”‚  case-index  â”‚                 â”‚  â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜                 â”‚  â”‚
â”‚  â”‚         â”‚                  â”‚                  â”‚                         â”‚  â”‚
â”‚  â”‚         â–¼                  â–¼                  â–¼                         â”‚  â”‚
â”‚  â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                  â”‚  â”‚
â”‚  â”‚    â”‚          Dense ê²€ìƒ‰ (Pinecone Vector Store)     â”‚                  â”‚  â”‚
â”‚  â”‚    â”‚          Upstage Embeddings (passage-query)     â”‚                  â”‚  â”‚
â”‚  â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                  â”‚  â”‚
â”‚  â”‚                           â”‚                                             â”‚  â”‚
â”‚  â”‚                           â–¼                                             â”‚  â”‚
â”‚  â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                  â”‚  â”‚
â”‚  â”‚    â”‚          Sparse ê²€ìƒ‰ (BM25)                      â”‚                 â”‚  â”‚
â”‚  â”‚    â”‚          â€¢ BM25-Text (ë³¸ë¬¸ ë‚´ìš©)                 â”‚                 â”‚  â”‚
â”‚  â”‚    â”‚          â€¢ BM25-Title (ì œëª©/ì¶œì²˜)                â”‚                 â”‚  â”‚
â”‚  â”‚    â”‚          Kiwi í˜•íƒœì†Œ ë¶„ì„ê¸° ì‚¬ìš©                  â”‚                 â”‚  â”‚
â”‚  â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                  â”‚  â”‚
â”‚  â”‚                           â”‚                                             â”‚  â”‚
â”‚  â”‚                           â–¼                                             â”‚  â”‚
â”‚  â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                  â”‚  â”‚
â”‚  â”‚    â”‚      RRF (Reciprocal Rank Fusion)               â”‚                  â”‚  â”‚
â”‚  â”‚    â”‚      3ì±„ë„ ê²°í•©: Dense + BM25-Text + BM25-Title  â”‚                  â”‚  â”‚
â”‚  â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                  â”‚  â”‚
â”‚  â”‚                           â”‚                                             â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                              â”‚ í›„ë³´ ë¬¸ì„œë“¤ (law + rule + case)                 â”‚
â”‚                              â–¼                                                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ STEP 3: ë¦¬ë­í‚¹ (Reranking)                                               â”‚  â”‚
â”‚  â”‚         â€¢ Cohere Reranker (rerank-multilingual-v3.0)                    â”‚  â”‚
â”‚  â”‚         â€¢ ìµœëŒ€ ì…ë ¥ ë¬¸ì„œ ìˆ˜ ì œí•œ (ê¸°ë³¸ 80ê°œ)                              â”‚  â”‚
â”‚  â”‚         â€¢ ë²•ë ¹/ê·œì • ìš°ì„  â†’ íŒë¡€ëŠ” ë‚¨ëŠ” ìŠ¬ë¡¯ë§Œ                              â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                  â”‚ reranked_docs                              â”‚
â”‚                                  â–¼                                            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ STEP 4: ì»¨í…ìŠ¤íŠ¸ í¬ë§·íŒ…                                                  â”‚  â”‚
â”‚  â”‚         â€¢ ë²•ì  ìœ„ê³„ êµ¬ë¶„ (SECTION 0/1/2/3)                               â”‚  â”‚
â”‚  â”‚           - SECTION 0: ì‚¬ìš©ì ê³„ì•½ì„œ OCR (ìˆì„ ê²½ìš°)                      â”‚  â”‚
â”‚  â”‚           - SECTION 1: í•µì‹¬ ë²•ë ¹ (priority 1, 2, 4, 5)                   â”‚  â”‚
â”‚  â”‚           - SECTION 2: ê´€ë ¨ ê·œì • (priority 3, 6, 7, 8, 11)               â”‚  â”‚
â”‚  â”‚           - SECTION 3: íŒë¡€/ì‚¬ë¡€                                         â”‚  â”‚
â”‚  â”‚         â€¢ ê° ë¬¸ì„œ: '{src_title} {article} - {text}' í˜•ì‹                 â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                  â”‚ formatted_context                          â”‚
â”‚                                  â–¼                                            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ STEP 5: ë‹µë³€ ìƒì„± (Answer Generation)                                    â”‚  â”‚
â”‚  â”‚         â€¢ OpenAI GPT-4o-mini ëª¨ë¸                                       â”‚  â”‚
â”‚  â”‚         â€¢ SYSTEM_PROMPT: ë²•ë¥  ìƒë‹´ ì§€ì¹¨ í¬í•¨                             â”‚  â”‚
â”‚  â”‚           - ë²•ì  ìœ„ê³„ ì¤€ìˆ˜                                               â”‚  â”‚
â”‚  â”‚           - ë‹µë³€ êµ¬ì¡°: í•µì‹¬/ê·¼ê±°/ì ˆì°¨/ì‚¬ë¡€/ì¶”ê°€í™•ì¸                        â”‚  â”‚
â”‚  â”‚           - ë©´ì±… ë¬¸êµ¬ í¬í•¨                                               â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                  â”‚                                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                   â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                              ì‘ë‹µ ë°˜í™˜                                         â”‚
â”‚  {                                                                            â”‚
â”‚    "normalized_query": "í‘œì¤€í™”ëœ ì§ˆë¬¸",                                        â”‚
â”‚    "references": ["ì£¼íƒì„ëŒ€ì°¨ë³´í˜¸ë²• ì œ3ì¡°", ...],                               â”‚
â”‚    "answer": "AI ìƒì„± ë‹µë³€",                                                   â”‚
â”‚    "docs": [...]                                                              â”‚
â”‚  }                                                                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```
---

## âœ¨ ì£¼ìš” ê¸°ëŠ¥

### 1. í•˜ì´ë¸Œë¦¬ë“œ ê²€ìƒ‰ (Hybrid Retrieval)
| êµ¬ë¶„ | ë°©ì‹ | ì„¤ëª… |
|------|------|------|
| **Dense** | Pinecone Vector Store | Upstage Embeddingsë¡œ ì˜ë¯¸ ìœ ì‚¬ì„± ê²€ìƒ‰ |
| **Sparse** | BM25 | í‚¤ì›Œë“œ ê¸°ë°˜ ì •í™• ë§¤ì¹­ (Kiwi í˜•íƒœì†Œ ë¶„ì„) |
| **Fusion** | RRF, Rank Sum, Weighted | Dense + BM25-Text + BM25-Title 3ì±„ë„ ë­í¬ ê²°í•© (ê¸°ë³¸ê°’: RRF) |

### 2. ì§ˆë¬¸ í‘œì¤€í™” (Query Normalization)
```
ì‚¬ìš©ì ì…ë ¥: "ì§‘ì£¼ì¸ì´ ë³´ì¦ê¸ˆ ì•ˆ ëŒë ¤ì¤˜ìš”"
       â†“ SOLAR Pro2 + KEYWORD_DICT
í‘œì¤€í™” ê²°ê³¼: "ì„ëŒ€ì¸ì´ ë³´ì¦ê¸ˆì„ ë°˜í™˜í•˜ì§€ ì•ŠëŠ” ê²½ìš° ëŒ€í•­ë ¥ ë° ìš°ì„ ë³€ì œê¶Œ í–‰ì‚¬ ë°©ë²•"
```

**í‚¤ì›Œë“œ ë³€í™˜ ì˜ˆì‹œ:**
| ì¼ìƒì–´ | ë²•ë¥  ìš©ì–´ |
|--------|-----------|
| ì§‘ì£¼ì¸/ê±´ë¬¼ì£¼ | ì„ëŒ€ì¸ |
| ì„¸ì…ì/ì‚´ë˜ ì‚¬ëŒ | ì„ì°¨ì¸ |
| ë³´ì¦ê¸ˆ ëŒë ¤ë°›ê¸° | ë³´ì¦ê¸ˆë°˜í™˜ì²­êµ¬ê¶Œ |
| ì¬ê³„ì•½/ì—°ì¥ | ê³„ì•½ê°±ì‹ ìš”êµ¬ê¶Œ |
| í™•ì •ì¼ì | ì£¼ë¯¼ë“±ë¡ + ì ìœ  + í™•ì •ì¼ì |

### 3. ë©€í‹°ì†ŒìŠ¤ ê²€ìƒ‰
| ì¸ë±ìŠ¤ | ë‚´ìš© | Pinecone ì¸ë±ìŠ¤ëª… |
|--------|------|-------------------|
| **law** | ì£¼íƒì„ëŒ€ì°¨ë³´í˜¸ë²• ë“± ë²•ë ¹ | `law-index` |
| **rule** | ì‹œí–‰ë ¹, ê·œì¹™, ì§€ì¹¨ ë“± ê·œì • | `rule-index` |
| **case** | ëŒ€ë²•ì›/í•˜ê¸‰ì‹¬ íŒë¡€ | `case-index` |

### 4. Cohere Reranker
- **ëª¨ë¸**: `rerank-multilingual-v3.0`
- **ëª©ì **: ê²€ìƒ‰ ê²°ê³¼ì˜ ê´€ë ¨ì„± ì¬í‰ê°€
- **ì „ëµ**: ë²•ë ¹/ê·œì • ìš°ì„  ìŠ¬ë¡¯ ë°°ë¶„ í›„ íŒë¡€ ì¶”ê°€

### 5. OCR ì§€ì›
| íŒŒì¼ ìœ í˜• | ì²˜ë¦¬ ë°©ì‹ |
|-----------|-----------|
| **í…ìŠ¤íŠ¸ PDF** | pdfplumberë¡œ í…ìŠ¤íŠ¸ ì§ì ‘ ì¶”ì¶œ |
| **ì´ë¯¸ì§€ PDF** | PyMuPDF ë Œë” â†’ EasyOCR/Tesseract OCR |
| **ì´ë¯¸ì§€ íŒŒì¼** | EasyOCR(ìš°ì„ ) â†’ Tesseract(í´ë°±) |

### 6. ë²•ì  ìœ„ê³„ êµ¬ë¶„
ë‹µë³€ ìƒì„± ì‹œ ì°¸ì¡° ë¬¸ì„œë¥¼ ë²•ì  íš¨ë ¥ ìˆœìœ¼ë¡œ êµ¬ë¶„:
1. **SECTION 0**: ì‚¬ìš©ì ê³„ì•½ì„œ OCR (ì‚¬ì‹¤ê´€ê³„)
2. **SECTION 1**: í•µì‹¬ ë²•ë ¹ (ìƒìœ„ ë²•ì  íš¨ë ¥)
3. **SECTION 2**: ê´€ë ¨ ê·œì • (ì„¸ë¶€ ì‹œí–‰ ê¸°ì¤€)
4. **SECTION 3**: íŒë¡€/ì‚¬ë¡€ (í•´ì„ ë° ì ìš© ì‚¬ë¡€)

### 7. íŒë¡€ í™•ì¥ (Case Expansion)
- **ëª©ì **: íŒë¡€ì˜ ì¼ë¶€ ë¬¸ì¥ë§Œ ê²€ìƒ‰ë˜ë”ë¼ë„, í•´ë‹¹ íŒë¡€ì˜ **ì „ë¬¸(Full Text)**ì„ ì»¨í…ìŠ¤íŠ¸ì— í¬í•¨í•˜ì—¬ ì •í™•í•œ í•´ì„ ìœ ë„
- **ë°©ì‹**: ë¦¬ë­í‚¹ í›„ ìƒìœ„ `k_case`ê°œ íŒë¡€ì— ëŒ€í•´ ì‚¬ê±´ë²ˆí˜¸ë¡œ ì „ë¬¸ì„ ì¡°íšŒí•˜ì—¬ ë³‘í•©

---

## ğŸ”„ ì²˜ë¦¬ ë‹¨ê³„ë³„ íë¦„

### Phase 1: ìš”ì²­ ìˆ˜ì‹  (Django View)
```python
# chatbot_app/chatbot/views.py
@csrf_exempt
def chat_api(request):
    # 1. ìš”ì²­ íŒŒì‹± (JSON ë˜ëŠ” multipart/form-data)
    # 2. íŒŒì¼ ì—…ë¡œë“œ ì‹œ OCR ì²˜ë¦¬
    # 3. RAG íŒŒì´í”„ë¼ì¸ í˜¸ì¶œ
    # 4. ì‘ë‹µ ë°˜í™˜
```

### Phase 2: OCR ì²˜ë¦¬ (ì„ íƒì‚¬í•­)
```python
# modules/ocr_module.py
extract_text_from_bytes(file_bytes, filename)
```
- **ì…ë ¥**: íŒŒì¼ ë°”ì´íŠ¸ + íŒŒì¼ëª…
- **ì¶œë ¥**: `OCRResult(mode, text, filename, detail)`
- **ì¶œë ¥**: `OCRResult(mode, text, filename, detail)`
- **í´ë°± ì²´ì¸**:
  1. **PDF**: pdfplumber(í…ìŠ¤íŠ¸) â†’ PyMuPDF(ì´ë¯¸ì§€ ë Œë”) â†’ EasyOCR/Tesseract
  2. **ì´ë¯¸ì§€**: EasyOCR(ìš°ì„ ) â†’ Tesseract(í´ë°±)

### Phase 3: ì§ˆë¬¸ í‘œì¤€í™”
```python
# modules/rag_module.py
pipeline.normalize_query(user_query)
```
- **ëª¨ë¸**: Upstage SOLAR Pro2 (`solar-pro2`)
- **í”„ë¡¬í”„íŠ¸**: ë²•ë¥  ìš©ì–´ ë³€í™˜ ì§€ì‹œ
- **í‚¤ì›Œë“œ ì‚¬ì „**: `KEYWORD_DICT` (100+ ë§¤í•‘)

### Phase 4: í•˜ì´ë¸Œë¦¬ë“œ ê²€ìƒ‰
```python
pipeline.triple_hybrid_retrieval(normalized_query)
```

**ë‹¨ê³„ë³„ ì²˜ë¦¬:**
1. **Dense ê²€ìƒ‰**: Pineconeì—ì„œ ê° ì¸ë±ìŠ¤ë³„ top-k í›„ë³´ ì¶”ì¶œ
2. **BM25 ìŠ¤ì½”ì–´ë§**: í›„ë³´ ë¬¸ì„œì— ëŒ€í•´ BM25 ì ìˆ˜ ê³„ì‚°
3. **RRF ê²°í•©**: 3ì±„ë„ ë­í¬ í“¨ì „
4. **Reranking**: Cohereë¡œ ìµœì¢… ìˆœìœ„ ê²°ì •
5. **ì¤‘ë³µ ì œê±°**: `chunk_id`/`id` ê¸°ë°˜ deduplication
6. **íŒë¡€ í™•ì¥**: ìƒìœ„ íŒë¡€ì˜ ì „ë¬¸(Full text) ë¡œë”© ë° ë³‘í•©

### Phase 5: ì»¨í…ìŠ¤íŠ¸ êµ¬ì„±
```python
pipeline.format_context_with_hierarchy(docs)
```
- **ìœ„ê³„ ë¶„ë¥˜**: priority ê°’ ê¸°ë°˜ SECTION ë¶„ë¥˜
- **í¬ë§·íŒ…**: `{src_title} {article} - {text}`
- **ê¸¸ì´ ì œí•œ**: ë¬¸ì„œë‹¹ `text_max_chars` ì œí•œ

### Phase 6: ë‹µë³€ ìƒì„±
```python
pipeline.generate_answer(user_input, extra_context=ocr_text)
```
- **ëª¨ë¸**: OpenAI GPT-4o-mini
- **Temperature**: 0.1 (ì¼ê´€ì„± ì¤‘ì‹œ)
- **êµ¬ì¡°**: SYSTEM_PROMPT ê¸°ë°˜ ë²•ë¥  ìƒë‹´ í˜•ì‹

---

## ğŸ“¦ í•µì‹¬ ëª¨ë“ˆ ìƒì„¸

### `rag_module.py` (1544 lines)

#### ì£¼ìš” í´ë˜ìŠ¤

| í´ë˜ìŠ¤ | ì„¤ëª… |
|--------|------|
| `RAGConfig` | íŒŒì´í”„ë¼ì¸ ì„¤ì • (ëª¨ë¸, íŒŒë¼ë¯¸í„° ë“±) |
| `RAGPipeline` | ë©”ì¸ íŒŒì´í”„ë¼ì¸ í´ë˜ìŠ¤ |
| `BM25InvertedIndex` | ê¸€ë¡œë²Œ BM25 ì—­ìƒ‰ì¸ (ì„ íƒì‚¬í•­) |
| `KiwiTokenizer` | Kiwi í˜•íƒœì†Œ ë¶„ì„ ê¸°ë°˜ í† í¬ë‚˜ì´ì € |
| `SimpleTokenizer` | Regex ê¸°ë°˜ í´ë°± í† í¬ë‚˜ì´ì € |

#### ì£¼ìš” ë©”ì„œë“œ (`RAGPipeline`)

| ë©”ì„œë“œ | ì„¤ëª… |
|--------|------|
| `normalize_query()` | ì§ˆë¬¸ í‘œì¤€í™” |
| `triple_hybrid_retrieval()` | 3-ì†ŒìŠ¤ í•˜ì´ë¸Œë¦¬ë“œ ê²€ìƒ‰ |
| `answer_with_trace()` | ë‹µë³€ ìƒì„± + ë©”íƒ€ë°ì´í„° ë°˜í™˜ |
| `generate_answer()` | ë‹µë³€ ë¬¸ìì—´ë§Œ ë°˜í™˜ |
| `format_context_with_hierarchy()` | ìœ„ê³„ë³„ ì»¨í…ìŠ¤íŠ¸ í¬ë§· |
| `format_references()` | UIìš© ì°¸ì¡° ëª©ë¡ ìƒì„± |

#### ì„¤ì • ì˜µì…˜ (`RAGConfig`)

```python
@dataclass
class RAGConfig:
    # ëª¨ë¸ ì„¤ì •
    normalize_model: str = "solar-pro2"        # ì§ˆë¬¸ í‘œì¤€í™” ëª¨ë¸
    generation_model: str = "gpt-4o-mini"      # ë‹µë³€ ìƒì„± ëª¨ë¸
    temperature: float = 0.1                    # ìƒì„± temperature

    # ê²€ìƒ‰ ì„¤ì • (ì¸ë±ìŠ¤ë³„ top-k)
    k_law: int = 7                              # ë²•ë ¹ ê²€ìƒ‰ ìˆ˜
    k_rule: int = 7                             # ê·œì • ê²€ìƒ‰ ìˆ˜
    k_case: int = 3                             # íŒë¡€ ê²€ìƒ‰ ìˆ˜
    search_multiplier: int = 4                  # 1ì°¨ ê²€ìƒ‰ ì‹œ í›„ë³´ ë°°ìˆ˜ (N * k)

    # BM25 ì„¤ì •
    enable_bm25: bool = True                    # BM25 í™œì„±í™”
    sparse_mode: str = "auto"                   # "auto" | "candidate" | "global"
    bm25_k1: float = 1.8                        # BM25 k1 íŒŒë¼ë¯¸í„°
    bm25_b: float = 0.85                        # BM25 b íŒŒë¼ë¯¸í„°

    # Fusion ì„¤ì •
    hybrid_fusion: str = "rrf"                  # "rrf" | "rank_sum" | "weighted"
    rrf_k: int = 60                             # RRF ìƒìˆ˜

    # Rerank ì„¤ì •
    enable_rerank: bool = True                  # Cohere rerank í™œì„±í™”
    rerank_model: str = "rerank-multilingual-v3.0"
    rerank_max_documents: int = 80              # ë¦¬ë­í¬ ìµœëŒ€ ì…ë ¥ ë¬¸ì„œ ìˆ˜
```

### `ocr_module.py` (237 lines)

#### ì£¼ìš” í•¨ìˆ˜

| í•¨ìˆ˜ | ì„¤ëª… |
|------|------|
| `extract_text_from_bytes()` | íŒŒì¼ ë°”ì´íŠ¸ â†’ OCR í…ìŠ¤íŠ¸ |
| `extract_text_from_path()` | íŒŒì¼ ê²½ë¡œ â†’ OCR í…ìŠ¤íŠ¸ |
| `legal_cleanup_min()` | ì¶”ì¶œ í…ìŠ¤íŠ¸ ìµœì†Œ ì •ë¦¬ |

#### OCR ì—”ì§„ ìš°ì„ ìˆœìœ„
1. **í…ìŠ¤íŠ¸ PDF**: pdfplumber (í…ìŠ¤íŠ¸ ì§ì ‘ ì¶”ì¶œ)
2. **ì´ë¯¸ì§€ PDF/ì´ë¯¸ì§€**: PyMuPDF ë Œë”ë§ í›„ EasyOCR (í•œêµ­ì–´ ìµœì í™”) â†’ Tesseract (í´ë°±)

---

## ğŸ“š ì£¼ìš” ë¼ì´ë¸ŒëŸ¬ë¦¬

### í•µì‹¬ í”„ë ˆì„ì›Œí¬
| ë¼ì´ë¸ŒëŸ¬ë¦¬ | ë²„ì „ | ìš©ë„ |
|-----------|------|------|
| `django` | â‰¥4.2 | ì›¹ í”„ë ˆì„ì›Œí¬ |
| `langchain-core` | â‰¥0.3.0 | LangChain ì½”ì–´ ê¸°ëŠ¥ |
| `langchain-community` | â‰¥0.3.0 | LangChain ì»¤ë®¤ë‹ˆí‹° í†µí•© |

### ë²¡í„° ìŠ¤í† ì–´ & ì„ë² ë”©
| ë¼ì´ë¸ŒëŸ¬ë¦¬ | ë²„ì „ | ìš©ë„ |
|-----------|------|------|
| `pinecone` | â‰¥5.0.0 | ë²¡í„° ë°ì´í„°ë² ì´ìŠ¤ |
| `langchain-pinecone` | â‰¥0.2.0 | LangChain-Pinecone í†µí•© |
| `langchain-upstage` | â‰¥0.3.0 | Upstage ì„ë² ë”©/ì±„íŒ… |

### LLM í”„ë¡œë°”ì´ë”
| ë¼ì´ë¸ŒëŸ¬ë¦¬ | ë²„ì „ | ìš©ë„ |
|-----------|------|------|
| `langchain-openai` | â‰¥0.2.0 | OpenAI GPT ëª¨ë¸ |
| `openai` | â‰¥1.0.0 | OpenAI API í´ë¼ì´ì–¸íŠ¸ |
| `cohere` | â‰¥5.0.0 | Cohere Reranker |

### NLP & í…ìŠ¤íŠ¸ ì²˜ë¦¬
| ë¼ì´ë¸ŒëŸ¬ë¦¬ | ë²„ì „ | ìš©ë„ |
|-----------|------|------|
| `kiwipiepy` | â‰¥0.18.0 | í•œêµ­ì–´ í˜•íƒœì†Œ ë¶„ì„ê¸° |
| `rank-bm25` | â‰¥0.2.2 | BM25 ì•Œê³ ë¦¬ì¦˜ |
| `tiktoken` | â‰¥0.7.0 | OpenAI í† í¬ë‚˜ì´ì € |

### OCR & ë¬¸ì„œ ì²˜ë¦¬
| ë¼ì´ë¸ŒëŸ¬ë¦¬ | ë²„ì „ | ìš©ë„ |
|-----------|------|------|
| `pdfplumber` | â‰¥0.10.0 | PDF í…ìŠ¤íŠ¸ ì¶”ì¶œ |
| `pymupdf` | â‰¥1.24.0 | PDF ë Œë”ë§ |
| `pytesseract` | â‰¥0.3.10 | Tesseract OCR ë°”ì¸ë”© |
| `pillow` | â‰¥10.0.0 | ì´ë¯¸ì§€ ì²˜ë¦¬ |
| `easyocr` | (ì„ íƒ) | ë”¥ëŸ¬ë‹ OCR (í•œêµ­ì–´ ìš°ìˆ˜) |

### ë°ì´í„° ì²˜ë¦¬
| ë¼ì´ë¸ŒëŸ¬ë¦¬ | ë²„ì „ | ìš©ë„ |
|-----------|------|------|
| `pandas` | â‰¥2.0.0 | ë°ì´í„° í”„ë ˆì„ |
| `numpy` | â‰¥1.26.0 | ìˆ˜ì¹˜ ì—°ì‚° |
| `pydantic` | â‰¥2.0.0 | ë°ì´í„° ê²€ì¦ |

---

## ğŸ“ í”„ë¡œì íŠ¸ êµ¬ì¡°

```
/
â”‚
â”œâ”€â”€ ğŸ“„ README.md                    # ì´ ë¬¸ì„œ
â”œâ”€â”€ ğŸ“„ requirements.txt             # Python ì˜ì¡´ì„±
â”œâ”€â”€ ğŸ“„ .env                         # í™˜ê²½ë³€ìˆ˜ (API í‚¤)
â”œâ”€â”€ ğŸ“„ kor.traineddata              # Tesseract í•œê¸€ ë°ì´í„°
â”‚
â”œâ”€â”€ ğŸ“ modules/                     # í•µì‹¬ ëª¨ë“ˆ
â”‚   â”œâ”€â”€ ğŸ“„ rag_module.py           # RAG íŒŒì´í”„ë¼ì¸ (1544 lines)
â”‚   â”‚   â”œâ”€â”€ RAGConfig              # ì„¤ì • í´ë˜ìŠ¤
â”‚   â”‚   â”œâ”€â”€ RAGPipeline            # ë©”ì¸ íŒŒì´í”„ë¼ì¸
â”‚   â”‚   â”œâ”€â”€ BM25InvertedIndex      # BM25 ì—­ìƒ‰ì¸
â”‚   â”‚   â”œâ”€â”€ KiwiTokenizer          # í˜•íƒœì†Œ ë¶„ì„ í† í¬ë‚˜ì´ì €
â”‚   â”‚   â””â”€â”€ ê²€ìƒ‰/ë¦¬ë­í¬/ìƒì„± ë¡œì§
â”‚   â”‚
â”‚   â””â”€â”€ ğŸ“„ ocr_module.py           # OCR ìœ í‹¸ (237 lines)
â”‚       â”œâ”€â”€ extract_text_from_bytes()
â”‚       â”œâ”€â”€ extract_text_from_path()
â”‚       â””â”€â”€ PDF/ì´ë¯¸ì§€ OCR ë¡œì§
â”‚
â””â”€â”€ ğŸ“ chatbot_app/                 # Django ì›¹ì•±
    â”œâ”€â”€ ğŸ“„ manage.py               # Django ê´€ë¦¬ ìŠ¤í¬ë¦½íŠ¸
    â”œâ”€â”€ ğŸ“„ db.sqlite3              # SQLite DB
    â”‚
    â”œâ”€â”€ ğŸ“ config/                 # Django ì„¤ì •
    â”‚   â”œâ”€â”€ settings.py
    â”‚   â”œâ”€â”€ urls.py
    â”‚   â””â”€â”€ wsgi.py
    â”‚
    â””â”€â”€ ğŸ“ chatbot/                # ì±—ë´‡ ì•±
        â”œâ”€â”€ ğŸ“„ views.py            # API ì—”ë“œí¬ì¸íŠ¸
        â”œâ”€â”€ ğŸ“„ urls.py             # URL ë¼ìš°íŒ…
        â””â”€â”€ ğŸ“ templates/chatbot/
            â””â”€â”€ ğŸ“„ index.html      # ì›¹ UI
```

---

## ğŸ›  ì„¤ì¹˜ ë° í™˜ê²½ ì„¤ì •

### 1. ì‚¬ì „ ìš”êµ¬ ì‚¬í•­
- **Python**: 3.10 ì´ìƒ
- **Tesseract OCR**: ì´ë¯¸ì§€ OCRìš© (ì„ íƒì‚¬í•­)

### 2. ê°€ìƒí™˜ê²½ ìƒì„± ë° í™œì„±í™”
```bash
# í”„ë¡œì íŠ¸ ë””ë ‰í† ë¦¬ë¡œ ì´ë™
cd 7_app

# ê°€ìƒí™˜ê²½ ìƒì„±
python -m venv .venv

# ê°€ìƒí™˜ê²½ í™œì„±í™” (Windows)
.venv\Scripts\activate

# ê°€ìƒí™˜ê²½ í™œì„±í™” (macOS/Linux)
source .venv/bin/activate
```

### 3. ì˜ì¡´ì„± ì„¤ì¹˜
```bash
pip install -r requirements.txt
```

### 4. Tesseract OCR ì„¤ì¹˜ (ì´ë¯¸ì§€ OCRìš©, ì„ íƒì‚¬í•­)

**Windows:**
```bash
winget install UB-Mannheim.TesseractOCR
```

**macOS:**
```bash
brew install tesseract tesseract-lang
```

**Ubuntu/Debian:**
```bash
sudo apt-get install tesseract-ocr tesseract-ocr-kor
```

**í•œê¸€ ë°ì´í„° ì„¤ì¹˜:**
- í”„ë¡œì íŠ¸ ë£¨íŠ¸ì˜ `kor.traineddata` íŒŒì¼ì„ Tesseract tessdata ë””ë ‰í† ë¦¬ì— ë³µì‚¬
- Windows ê¸°ë³¸ ê²½ë¡œ: `C:\Program Files\Tesseract-OCR\tessdata\`

### 5. í™˜ê²½ë³€ìˆ˜ ì„¤ì •

`.env` íŒŒì¼ì„ ìƒì„±í•˜ê³  ë‹¤ìŒ API í‚¤ë¥¼ ì„¤ì •:

```bash
# .env íŒŒì¼ (chatbot_app/ ë˜ëŠ” ë£¨íŠ¸ì— ìœ„ì¹˜)
UPSTAGE_API_KEY=your_upstage_api_key
PINECONE_API_KEY=your_pinecone_api_key
COHERE_API_KEY=your_cohere_api_key
OPENAI_API_KEY=your_openai_api_key
```

**API í‚¤ ë°œê¸‰ ì•ˆë‚´:**
| ì„œë¹„ìŠ¤ | ìš©ë„ | ë°œê¸‰ ë§í¬ |
|--------|------|-----------|
| **Upstage** | ì„ë² ë”©, ì§ˆë¬¸ í‘œì¤€í™” | https://console.upstage.ai |
| **Pinecone** | ë²¡í„° ìŠ¤í† ì–´ | https://app.pinecone.io |
| **Cohere** | ë¦¬ë­í‚¹ | https://dashboard.cohere.com |
| **OpenAI** | ë‹µë³€ ìƒì„± | https://platform.openai.com |

---

## ğŸš€ ì‹¤í–‰ ë°©ë²•

### ê°œë°œ ì„œë²„ ì‹¤í–‰

```bash
# chatbot_app ë””ë ‰í† ë¦¬ë¡œ ì´ë™
cd chatbot_app

# Django ê°œë°œ ì„œë²„ ì‹œì‘
python manage.py runserver 8000
```

### ì ‘ì†
- ë¸Œë¼ìš°ì €ì—ì„œ http://localhost:8000/ ì ‘ì†
- ë˜ëŠ” API ì§ì ‘ í˜¸ì¶œ

---

## ğŸ“¡ API ì‚¬ìš©ë²•

### ì—”ë“œí¬ì¸íŠ¸
```
POST /api/chat/
```

### 1. í…ìŠ¤íŠ¸ ì§ˆë¬¸ (JSON)

```bash
curl -X POST http://localhost:8000/api/chat/ \
  -H "Content-Type: application/json" \
  -d '{"message": "ì „ì„¸ ë³´ì¦ê¸ˆ ë°˜í™˜ ì ˆì°¨ëŠ” ì–´ë–»ê²Œ ë˜ë‚˜ìš”?"}'
```

### 2. íŒŒì¼ ì²¨ë¶€ ì§ˆë¬¸ (Multipart)

```bash
curl -X POST http://localhost:8000/api/chat/ \
  -F "message=ì´ ê³„ì•½ì„œì—ì„œ ë¬¸ì œì ì´ ìˆë‚˜ìš”?" \
  -F "files=@contract.pdf"
```

### 3. ë³µìˆ˜ íŒŒì¼ ì²¨ë¶€

```bash
curl -X POST http://localhost:8000/api/chat/ \
  -F "message=ì´ ê³„ì•½ì„œë“¤ì„ ë¹„êµ ë¶„ì„í•´ì£¼ì„¸ìš”" \
  -F "files=@contract1.pdf" \
  -F "files=@contract2.jpg"
```

### ì‘ë‹µ í˜•ì‹

```json
{
  "normalized_query": "ì„ëŒ€ì°¨ ê³„ì•½ ì¢…ë£Œ ì‹œ ë³´ì¦ê¸ˆ ë°˜í™˜ ì²­êµ¬ ì ˆì°¨ ë° ëŒ€í•­ë ¥ í–‰ì‚¬ ë°©ë²•",
  "references": [
    "ì£¼íƒì„ëŒ€ì°¨ë³´í˜¸ë²•(ë²•ë¥ )(ì œ21065í˜¸) ì œ3ì¡°(ëŒ€í•­ë ¥ ë“±)",
    "ì£¼íƒì„ëŒ€ì°¨ë³´í˜¸ë²•(ë²•ë¥ )(ì œ21065í˜¸) ì œ3ì¡°ì˜2(ë³´ì¦ê¸ˆì˜ íšŒìˆ˜)",
    "ëŒ€ë²•ì› 2023ë‹¤123456 íŒê²°"
  ],
  "answer": "## ì „ì„¸ ë³´ì¦ê¸ˆ ë°˜í™˜ ì ˆì°¨\n\n### 1. í•µì‹¬ ìš”ì•½\nì „ì„¸ ê³„ì•½ì´ ì¢…ë£Œë˜ë©´ ì„ì°¨ì¸ì€ ...",
  "docs": [...]
}
```

### ì‘ë‹µ í•„ë“œ ì„¤ëª…

| í•„ë“œ | ì„¤ëª… |
|------|------|
| `normalized_query` | ë²•ë¥  ìš©ì–´ë¡œ í‘œì¤€í™”ëœ ì§ˆë¬¸ |
| `references` | ì°¸ì¡°ëœ ë²•ë ¹/ê·œì •/íŒë¡€ ëª©ë¡ (src_title + article) |
| `answer` | LLMì´ ìƒì„±í•œ ë²•ë¥  ìƒë‹´ ë‹µë³€ |
| `docs` | ê²€ìƒ‰ëœ ì›ë³¸ ë¬¸ì„œ ê°ì²´ ë¦¬ìŠ¤íŠ¸ (ë””ë²„ê¹…ìš©) |

---

## âš™ ì„¤ì • ì»¤ìŠ¤í„°ë§ˆì´ì§•

### RAGConfig ì˜µì…˜ ì¡°ì • (í•„ìš” ì‹œ)

`chatbot_app/chatbot/views.py`ì—ì„œ íŒŒì´í”„ë¼ì¸ ì„¤ì • ë³€ê²½:

```python
config = RAGConfig(
    # ëª¨ë¸ ì„ íƒ
    normalize_model="solar-pro2",       # ë˜ëŠ” ë‹¤ë¥¸ Upstage ëª¨ë¸
    generation_model="gpt-4o-mini",     # ë˜ëŠ” "gpt-4o", "gpt-3.5-turbo"
    temperature=0.1,                     # ë‚®ì„ìˆ˜ë¡ ì¼ê´€ëœ ë‹µë³€
    
    # ê²€ìƒ‰ íŠœë‹ (ê° ì¸ë±ìŠ¤ë³„ kê°’ ì¡°ì •)
    k_law=10,                            # ë²•ë ¹ ê²€ìƒ‰ ìˆ˜ ì¦ê°€
    k_case=5,                            # íŒë¡€ ê²€ìƒ‰ ìˆ˜ ì¦ê°€
    search_multiplier=5,                 # í›„ë³´êµ° 5ë°°ìˆ˜ ê²€ìƒ‰
    
    # í•˜ì´ë¸Œë¦¬ë“œ ê²€ìƒ‰
    enable_bm25=True,                    # BM25 í™œì„±í™”
    bm25_algorithm="okapi",              # "okapi" ë˜ëŠ” "bm25l"
    
    # ë¦¬ë­í‚¹
    enable_rerank=True,                  # Cohere rerank í™œì„±í™”
    rerank_max_docs=80,                  # ë¦¬ë­í¬ ìµœëŒ€ ì…ë ¥ ë¬¸ì„œ
)
```

### ì„ë² ë”© ë°±ì—”ë“œ ë³€ê²½

```python
config = RAGConfig(
    embedding_backend="upstage",  # "upstage" ë˜ëŠ” "openai"
)
```

### BM25 íŒŒë¼ë¯¸í„° íŠœë‹

```python
config = RAGConfig(
    bm25_k1=1.8,      # ìš©ì–´ ë¹ˆë„ ì˜í–¥ (ê¸°ë³¸ê°’: 1.8)
    bm25_b=0.85,      # ë¬¸ì„œ ê¸¸ì´ ì •ê·œí™” (ê¸°ë³¸ê°’: 0.85)
)
```

---

## ğŸ”§ ë¬¸ì œ í•´ê²°

### ìì£¼ ë°œìƒí•˜ëŠ” ì˜¤ë¥˜

#### 1. API í‚¤ ì˜¤ë¥˜
```
Error: OPENAI_API_KEY not found
```
**í•´ê²°**: `.env` íŒŒì¼ì— í•´ë‹¹ API í‚¤ê°€ ì„¤ì •ë˜ì–´ ìˆëŠ”ì§€ í™•ì¸

#### 2. Pinecone ì—°ê²° ì˜¤ë¥˜
```
Error: Failed to connect to Pinecone
```
**í•´ê²°**: 
- Pinecone API í‚¤ í™•ì¸
- ì¸ë±ìŠ¤ ì´ë¦„(`law-index`, `rule-index`, `case-index`)ì´ ì¡´ì¬í•˜ëŠ”ì§€ í™•ì¸

#### 3. OCR ì‹¤íŒ¨
```
Warning: Tesseract not found
```
**í•´ê²°**: Tesseract OCR ì„¤ì¹˜ ë° PATH ì„¤ì •, ë˜ëŠ” EasyOCR ì‚¬ìš©

#### 4. ë©”ëª¨ë¦¬ ë¶€ì¡±
```
Error: Out of memory
```
**í•´ê²°**:
- `k_law`, `k_rule` ê°’ ë‚®ì¶”ê¸°
- `rerank_max_documents` ê°’ ë‚®ì¶”ê¸°
- íŒŒì´í”„ë¼ì¸ ì‹±ê¸€í„´ íŒ¨í„´ í™•ì¸ (views.pyì˜ `get_pipeline()`)

### ë””ë²„ê¹… íŒ

#### ë¡œê·¸ ë ˆë²¨ ì¡°ì •
```python
import logging
logging.basicConfig(level=logging.DEBUG)
```

#### íŒŒì´í”„ë¼ì¸ ìƒíƒœ í™•ì¸
```python
rag = get_pipeline()
print(f"Law store: {rag.law_store}")
print(f"BM25 enabled: {rag.cfg.enable_bm25}")
print(f"Rerank enabled: {rag.cfg.enable_rerank}")
```

---

## ğŸ“œ ë¼ì´ì„ ìŠ¤

ì´ í”„ë¡œì íŠ¸ëŠ” í•™ìŠµ/ì—°êµ¬ ëª©ì ìœ¼ë¡œ ê°œë°œë˜ì—ˆìŠµë‹ˆë‹¤.

---

## ğŸ”— ê´€ë ¨ ë§í¬

- [Pinecone ë¬¸ì„œ](https://docs.pinecone.io/)
- [LangChain ë¬¸ì„œ](https://python.langchain.com/)
- [Upstage API](https://developers.upstage.ai/)
- [Cohere Rerank](https://docs.cohere.com/reference/rerank)
- [êµ­ê°€ë²•ë ¹ì •ë³´ì„¼í„°](https://www.law.go.kr/main.html)
